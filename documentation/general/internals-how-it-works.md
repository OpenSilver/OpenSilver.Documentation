# Internals - How does OpenSilver work internally?

## In-depth video

> [!Video https://www.youtube.com/embed/xaTtev_VV2k]

## Internals overview

An OpenSilver project is none other than a .NET Standard type project that references the OpenSilver NuGet package. The presence of this NuGet package has several consequences.

### 1. References

First, the NuGet package will add a reference to the "OpenSilver.dll" assembly, which contains the implementation of the XAML classes. For example, the "Button" and "TextBox" classes are located there.
These classes can be seen by going to the "[src/Runtime/Runtime](https://github.com/OpenSilver/OpenSilver/tree/master/src/Runtime/Runtime)" directory of the OpenSilver source code on GitHub, at the address: https://github.com/OpenSilver/OpenSilver

Low-level elements, such as the "TextBox", "MediaElement" or "WebBrowser" controls, contain a method named "CreateDomElement", which specifies how they should render in HTML.

For example, "TextBox" will create a `<div>` in html, "MediaElement" will create a tag `<video>` in html and "WebBrowser" will create a `<iframe>` in html.

![Source Code](/images/12.SourceCode.png "The source code of the WebBrowser control")

In addition, there is a correspondence that is made between XAML properties and CSS properties. For example, the property “Foreground” in XAML will have as equivalent the property “color” in CSS. As another example, the "Source" property of the "WebBrowser" control will have as equivalent the "src" property of `<iframe>`.

![Properties Definition](/images/13.ForegroundProperties.png "The definition of the Foreground property")

### 2. The compiler

Next, the NuGet package adds a few steps to the Msbuild compilation.

This can be seen by opening the contents of the NuGet package where it is installed (usually in C:\Users&#92;%USERNAME%&#92;.Nuget\packages\opensilver\). By opening the "build" directory, it is possible to see the presence of two .target files, which will alter the behavior of Msbuild.

![Folder Build](/images/14.FolderBuild.png "The contents of the Build directory in the NuGet package")

One of the key compilation steps is the conversion of XAML files to auto-generated C# files. In fact, the compiler replaces XAML files with strictly equivalent C# code. For example, the following XAML code:

```
<StackPanel HorizontalAlignment="Left">
  <TextBlock Text="Enter some text below:"/>
  <TextBox x:Name="MyTextBox1"/>
  <Button Content="Click me" Click="Button_Click"/>
</StackPanel>
```

is replaced by the following auto-generated code:
```
var stackPanel1 = new StackPanel() { HorizontalAlignment = HorizontalAlignment.Left };
var textBlock1 = new TextBlock() { Text = "Enter some text below:" };
stackPanel1.Children.Add(textBlock1);
var textBox1 = new TextBox() { Name = "MyTextBox1" };
stackPanel1.Children.Add(textBox1);
this.MyTextBox1 = textBox1;
var button1 = new Button() { Content = "Click me" };
button1.Click += Button_Click;
stackPanel1.Children.Add(button1);
```

One can see this auto-generated code by going to the “obj/Debug” directory of the project and by opening the “MainPage.xaml.True.g.cs” file (after compiling the project).

![Generated Code](/images/15.autoGeneratedCode.png "The auto-generated MainPage.xaml.True.g.cs file")

### 3. The satellite projects

In the Visual Studio solution, in addition to the main application project (the one containing App.xaml), we mentioned two other projects, which serve as entry points:

* The .Browser project is an ASP.NET Client-Side Blazor type project. It references the main project of the application and allows to run it in WebAssembly

* The .Simulator project is a .NET Framework type project whose purpose is to launch the app as a desktop application with a bunch of handy helpers for a developer, including the ability to debug the application.


![OpenSilver solution](/images/3.solutionExplorer.png "The three projects of a typical OpenSilver solution")

### 4. The Simulator

The Simulator is a tool which is distributed as a NuGet package. Usually it is located in the C:\Users\%USERNAME%\.Nuget\packages\opensilver.simulator.

![Simulator Folder](/images/16.SimulatorFolder.png "The contents of the Simulator directory in the NuGet package")

It is a WPF-type application that contains an embedded Chromium browser. The goal of the Simulator is to allow debugging the application with the very powerful tools of the .NET Framework. It also allows to inspect the XAML visual tree.

![Simulator Visual Tree](/images/11.VisualTree.png "The Simulator visual tree inspector")

Its internal operation is as follows: when the Simulator launches, it starts the application via an "Activator.CreateInstance". This is possible because the application DLL is .NET Standard compatible. Then, the Simulator instantiates several methods in the application to handle interops and to analyze the components tree. Finally, the application is running in the .NET Framework context.

All HTML and CSS manipulations are redirected by the Simulator to the embedded browser (chromium) via C# <-> JavaScript interops (see corresponding section). JavaScript events are connected to C# events.
